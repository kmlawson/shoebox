<script type="text/javascript">
 function displayAll(yesno) {
       var myItem = document.getElementById('showall');
       if(yesno == 1)
          myItem.style.display = 'block';
       else
          myItem.style.display = 'none';
        window.scroll(0,175)
}
</script>

<p>Below are places mentioned on more than one occasion in the letters. Scroll to zoom in/out. Click and drag to move the map.</p>

<iframe name="mapFrame" src="https://huginn.net/shoebox/map/index.html" width="100%" height="500" style="border: 1px solid #ccc;"></iframe>

<p><a href="https://huginn.net/shoebox/map/index.html" target="mapFrame" onClick="displayAll(0)" style="display:none;" id="showall">Display all Locations</a></p>

<p>Focus on a single location by clicking on it below:</p>

<ul>
<?php
//Parse the location csv file and output the list.
$csvfile='/home/kmlawson/huginn.net/shoebox/map/locations.csv';

$fileasarray=file($csvfile);
if (!$fileasarray) {
    exit('Location file could not be found or read.');
}
sort($fileasarray);
foreach ($fileasarray as $locationdata)
{
    $row=explode(',',$locationdata);
    ?>
<li><strong><a href="https://huginn.net/shoebox/map/getloc.php?title=<?php echo urlencode($row[0]); ?>&latlong=<?php echo trim($row[2]) . "," . trim($row[3]); ?>" target="mapFrame" onClick="displayAll(1)"><?php echo htmlspecialchars($row[0]); ?></a></strong> - <?php echo htmlspecialchars($row[1]); ?> (<a href="https://huginn.net/shoebox/letters/items/browse?tags=<?php echo urlencode($row[0]); ?>">Items</a>)</li>
<?php
}
?>
</ul>
